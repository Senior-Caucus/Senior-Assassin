{% extends "base.html" %}

{% block title %}Admin Dashboard{% endblock %}

{% block content %}
  <div class="admin-dashboard">
    <div class="admin-meta">
      <h2 class="nosifer-regular">SENIOR ASSASSIN</h2>
      <div class="meta-stats">
        <p>ðŸ‘¥ Assassins: <strong>{{ num_alive_users }}</strong></p>
        <p>ðŸ’€ Approved Evidence: <strong>{{num_approved_evidence}}</strong></p>
        <p>ðŸ“¹ Denied Evidence: <strong>{{num_unapproved_evidence}}</strong></p>
        <p>ðŸ•’ Awaiting Evidence: <strong>{{num_awaiting_evidence}}</strong></p>
      </div>
    </div>
<!-- awaiting_evidence = [
        {
            "evidence_id": row[0],
            "assassin": row[1],
            "target": row[2],
            "evidence_path": row[3]
        }
        for row in evidence_values[1:] if row[approved_index] == "None" or row[approved_index] == "NONE"
    ] -->
    <div class="admin-table">
      <table>
        <thead>
          <tr>
            <th>Assassin</th>
            <th>Target</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
        {% for ev in awaiting_evidence %}
          <tr id="row-{{ ev.evidence_id }}">
            <td>{{ ev.assassin }}</td>
            <td>{{ ev.target }}</td>
            <td>
              <button
                class="review-btn"
                data-video-url="/admin/video_evidence/{{ ev.full_evidence_path }}"
                data-id="{{ ev.evidence_id }}"
                data-assassin-url="/profile_picture/{{ ev.assassin }}/profile_pic.jpg"
                data-target-url="/profile_picture/{{ ev.target }}/profile_pic.jpg"
              >
                Review
              </button>
            </td>
          </tr>
        {% endfor %}
      </tbody>
      </table>
    </div>
  </div>

  <!-- Modal -->
  <div id="review-modal" class="modal hidden">
    <div class="modal-content">
      <button class="close-btn">&times;</button>

      <h3>Review Evidence</h3>
      <!-- <div class="profiles">
        <div>
          <p>Assassin Picture</p>
          <img id="assassin-pic" alt="Assassin's profile" src="" />
        </div>
        <div>
          <p>Target Picture</p>
          <img id="target-pic"   alt="Target's profile"   src="" />
        </div>
      </div> -->

      <video id="evidence-video" controls></video>

      <div class="modal-actions">
        <button class="approve-btn">Approve</button>
        <button class="deny-btn">Deny</button>
      </div>
    </div>
  </div>
{% endblock %}

{% block scripts %}
<script src="/static/js/admin.js"></script>
<!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-076DG6NV1N"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-076DG6NV1N');
  </script>
{% endblock %}