{% extends "base.html" %}

{% block title %}Admin Dashboard{% endblock %}

{% block content %}
  <div class="admin-dashboard">
    <div class="admin-meta">
      <h2 class="nosifer-regular">SENIOR ASSASSIN</h2>
      <div class="meta-stats">
        <p>ðŸ‘¥ Assassins: <strong>{{ num_alive_users }}</strong></p>
        <p>ðŸ’€ Approved Evidence: <strong>{{num_approved_evidence}}</strong></p>
        <p>ðŸ“¹ Unapproved Evidence: <strong>{{num_unapproved_evidence}}</strong></p>
        <p>ðŸ•’ Awaiting Evidence: <strong>{{num_awaiting_evidence}}</strong></p>
      </div>
    </div>
<!-- awaiting_evidence = [
        {
            "evidence_id": row[0],
            "assassin": row[1],
            "target": row[2],
            "evidence_path": row[3]
        }
        for row in evidence_values[1:] if row[approved_index] == "None" or row[approved_index] == "NONE"
    ] -->
    <div class="admin-table">
      <table>
        <thead>
          <tr>
            <th>Assassin</th>
            <th>Target</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
        {% for ev in awaiting_evidence %}
          <tr id="row-{{ ev.evidence_id }}">
            <td>{{ ev.assassin }}</td>
            <td>{{ ev.target }}</td>
            <td>
              <button
                class="review-btn"
                data-video-url="/video_evidence/{{ ev.evidence_id }}"
                data-id="{{ ev.evidence_id }}"
              >
                Review
              </button>
            </td>
          </tr>
        {% endfor %}
      </tbody>
      </table>
    </div>
  </div>

  <!-- Modal -->
  <div id="review-modal" class="modal hidden">
    <div class="modal-content">
      <button class="close-btn">&times;</button>
      <video id="evidence-video" controls></video>
      <div class="modal-actions">
        <button class="approve-btn">Approve</button>
        <button class="deny-btn">Deny</button>
      </div>
    </div>
  </div>
{% endblock %}

{% block scripts %}
<script src="/static/js/admin.js"></script>
{% endblock %}